/*! knockout-image-rotator 2014-06-17 */

function RotatedImage(a){this.properties={path:ko.observable(a),width:ko.observable("100%"),height:ko.observable("100%"),orientation:ko.observable("1"),top:ko.observable("0px")};var b=this,c=document.createElement("img");c.addEventListener("image-resize",function(){b.initImage()},!1),this.element=ko.observable(c),this.parseImage()}var ImageRotator=function(a){return{init:function(){a.bindingHandlers.rotatedImage={update:function(b,c,d,e){var f=a.utils.unwrapObservable(c());f.style.top=e.properties.top(),b.innerHTML="",b.appendChild(f)}},window.addEventListener("resize",function(){for(var a=document.querySelectorAll(".rotated-image"),b=new Event("image-resize"),c=0,d=a.length;d>c;c++){var e=a[c];e.dispatchEvent(b)}},!0)}}}(window.ko);RotatedImage.prototype.initImage=function(){var a=this,b=this.element();b.onload=function(){var c=b.clientWidth||b.width,d=b.clientHeight||b.height;switch(a.properties.orientation()){case 5:case 6:case 7:case 8:a.properties.width(d+"px"),a.properties.height(c+"px");var e=(c-d)/2;a.properties.top(e+"px");break;default:a.properties.width(c+"px"),a.properties.height(d+"px")}},b.className="rotated-image exif-orientation-"+a.properties.orientation(),b.style.maxWidth="100%",b.setAttribute("src",this.properties.path())},RotatedImage.prototype.parseImage=function(){var a=this,b=function(b){a.properties.orientation(b.orientation),a.initImage()},c=new XMLHttpRequest;c.open("GET",a.properties.path()),c.responseType="blob",c.onload=function(){var a={orientation:"1"};if(4===c.readyState&&200===c.status){var d=c.response,e=function(c){a.orientation=c.exif[274]||"1",b(a)},f={maxMetaDataSize:262144,disableImageHead:!1};try{loadImage.parseMetaData(d,e,f)}catch(g){console.warn("Error parsing image meta data: "+g.message),b(a)}}},c.send()};
//# sourceMappingURL=knockout-image-rotator.min.js.map